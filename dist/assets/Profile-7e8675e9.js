import{aa as T,ab as o,ac as E,u as $,f,a as s,j as e,C as w,A as z,U as S,s as v,ad as C,B as H,ae as q,af as A,I as n,$ as m}from"./index-7e43eeaa.js";import{g as V}from"./submissions-daaf532e.js";import{U as D,a as K,m as Q}from"./UploadOutlined-65b8399a.js";import{R as G,C as u}from"./row-43cc7f0c.js";import{S as p}from"./index-3a5ddc68.js";import{F as U}from"./index-8494a245.js";import{P as J,H as W}from"./PhoneOutlined-2a472f7c.js";import{C as X}from"./CheckCircleOutlined-8efca08c.js";import{T as Y}from"./TrophyOutlined-3606b085.js";import{S as O}from"./SaveOutlined-c79f92fe.js";import"./fade-e1fcf046.js";import"./DeleteOutlined-133431b9.js";import"./DownloadOutlined-626b5515.js";import"./progress-213077d5.js";import"./index-d2f8d546.js";import"./useForm-872d7ca5.js";const{TabPane:k}=q,Z=T().shape({name:o().required("Name is required"),email:o().email("Invalid email").required("Email is required"),phone:o(),address:o()}),_=T().shape({currentPassword:o().required("Current password is required"),newPassword:o().min(6,"Password must be at least 6 characters").required("New password is required"),confirmPassword:o().oneOf([E("newPassword"),null],"Passwords must match").required("Please confirm your password")}),we=()=>{var N,y;const{user:i,updateUser:P}=$(),[j,F]=f.useState("1"),[L,b]=f.useState(!1),[I,x]=f.useState(!1),B=async r=>{b(!0);try{await new Promise(a=>setTimeout(a,1e3)),P(r),m.success("Profile updated successfully!")}catch{m.error("Failed to update profile")}finally{b(!1)}},M=async(r,{resetForm:a})=>{x(!0);try{await new Promise(t=>setTimeout(t,1e3)),m.success("Password changed successfully!"),a()}catch{m.error("Failed to change password")}finally{x(!1)}},R=r=>{if(r.file.status==="done"){const a=URL.createObjectURL(r.file.originFileObj);P({avatar:a}),Q.success("Avatar updated successfully")}},g=V(i.id),d=g.filter(r=>r.status==="evaluated"),c={totalAssessments:g.length,completedAssessments:d.length,averageScore:d.length>0?Math.round(d.reduce((r,a)=>r+a.percentage,0)/d.length):0,topSubject:"Computer Science"};return s("div",{className:"p-6 max-w-4xl mx-auto",children:[s("div",{className:"mb-6",children:[e("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"My Profile"}),e("p",{className:"text-gray-600 dark:text-gray-400",children:"Manage your account information and preferences"})]}),s("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s("div",{className:"lg:col-span-1",children:[s(w,{className:"text-center",children:[e(z,{size:120,src:i.avatar,icon:e(S,{}),className:"mb-4"}),e("h2",{className:"text-xl font-bold mb-2",children:i.name}),e("p",{className:"text-gray-600 mb-4",children:i.role.charAt(0).toUpperCase()+i.role.slice(1)}),e(D,{showUploadList:!1,beforeUpload:()=>!1,onChange:R,children:e(v,{icon:e(K,{}),children:"Change Avatar"})}),s("div",{className:"mt-6 space-y-2 text-left",children:[s("div",{className:"flex items-center space-x-2",children:[e(C,{}),e("span",{className:"text-sm",children:i.email})]}),e("div",{className:"flex items-center space-x-2",children:s("span",{className:"text-sm",children:["Institute: ",i.instituteCode]})})]})]}),e(w,{className:"mt-6",title:"Performance Overview",children:s(G,{gutter:[16,16],children:[e(u,{span:12,children:e(p,{title:"Total Assessments",value:c.totalAssessments,prefix:e(H,{}),valueStyle:{color:"#1890ff"}})}),e(u,{span:12,children:e(p,{title:"Completed",value:c.completedAssessments,prefix:e(X,{}),valueStyle:{color:"#52c41a"}})}),e(u,{span:12,children:e(p,{title:"Average Score",value:c.averageScore,suffix:"%",prefix:e(Y,{}),valueStyle:{color:"#722ed1"}})}),e(u,{span:12,children:e(p,{title:"Top Subject",value:c.topSubject,valueStyle:{fontSize:"14px"}})})]})})]}),e("div",{className:"lg:col-span-2",children:e(w,{children:s(q,{activeKey:j,onChange:F,children:[e(k,{tab:"Personal Information",children:e(A,{initialValues:{name:i.name||"",email:i.email||"",phone:((N=i.profile)==null?void 0:N.phone)||"",address:((y=i.profile)==null?void 0:y.address)||""},validationSchema:Z,onSubmit:B,children:({values:r,errors:a,touched:t,handleChange:l,handleSubmit:h})=>s(U,{layout:"vertical",onSubmit:h,children:[s("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s("div",{children:[e("label",{className:"block text-sm font-medium mb-2",children:"Full Name"}),e(n,{name:"name",value:r.name,onChange:l,prefix:e(S,{}),status:a.name&&t.name?"error":""}),a.name&&t.name&&e("div",{className:"text-red-500 text-sm mt-1",children:a.name})]}),s("div",{children:[e("label",{className:"block text-sm font-medium mb-2",children:"Email"}),e(n,{name:"email",value:r.email,onChange:l,prefix:e(C,{}),status:a.email&&t.email?"error":""}),a.email&&t.email&&e("div",{className:"text-red-500 text-sm mt-1",children:a.email})]}),s("div",{children:[e("label",{className:"block text-sm font-medium mb-2",children:"Phone"}),e(n,{name:"phone",value:r.phone,onChange:l,prefix:e(J,{})})]}),s("div",{children:[e("label",{className:"block text-sm font-medium mb-2",children:"Address"}),e(n,{name:"address",value:r.address,onChange:l,prefix:e(W,{})})]})]}),e("div",{className:"mt-6",children:e(v,{type:"primary",htmlType:"submit",icon:e(O,{}),loading:L,children:"Update Profile"})})]})})},"1"),e(k,{tab:"Change Password",children:e(A,{initialValues:{currentPassword:"",newPassword:"",confirmPassword:""},validationSchema:_,onSubmit:M,children:({values:r,errors:a,touched:t,handleChange:l,handleSubmit:h})=>s(U,{layout:"vertical",onSubmit:h,children:[s("div",{className:"space-y-4",children:[s("div",{children:[e("label",{className:"block text-sm font-medium mb-2",children:"Current Password"}),e(n.Password,{name:"currentPassword",value:r.currentPassword,onChange:l,status:a.currentPassword&&t.currentPassword?"error":""}),a.currentPassword&&t.currentPassword&&e("div",{className:"text-red-500 text-sm mt-1",children:a.currentPassword})]}),s("div",{children:[e("label",{className:"block text-sm font-medium mb-2",children:"New Password"}),e(n.Password,{name:"newPassword",value:r.newPassword,onChange:l,status:a.newPassword&&t.newPassword?"error":""}),a.newPassword&&t.newPassword&&e("div",{className:"text-red-500 text-sm mt-1",children:a.newPassword})]}),s("div",{children:[e("label",{className:"block text-sm font-medium mb-2",children:"Confirm New Password"}),e(n.Password,{name:"confirmPassword",value:r.confirmPassword,onChange:l,status:a.confirmPassword&&t.confirmPassword?"error":""}),a.confirmPassword&&t.confirmPassword&&e("div",{className:"text-red-500 text-sm mt-1",children:a.confirmPassword})]})]}),e("div",{className:"mt-6",children:e(v,{type:"primary",htmlType:"submit",icon:e(O,{}),loading:I,children:"Change Password"})})]})})},"2")]})})})]})]})};export{we as default};
