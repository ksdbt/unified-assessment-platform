import{f as m,o as R,p as U,a as n,j as e,C as g,B as _,I as v,q as w,a0 as N,s as d,$ as c,ag as Q,a8 as J,X as K}from"./index-7e43eeaa.js";import{a as X,u as b,e as G}from"./assessments-75df469f.js";import{s as k}from"./submissions-daaf532e.js";import{R as W,C as y}from"./row-43cc7f0c.js";import{S}from"./index-3a5ddc68.js";import{T as Y}from"./Table-8d2bfa3e.js";import{M as Z}from"./index-3d906005.js";import{F as o}from"./index-8494a245.js";import{T as I}from"./index-cdc86ff5.js";import{P as ee}from"./index-292e3508.js";import{C as se}from"./CheckCircleOutlined-8efca08c.js";import{S as te}from"./StopOutlined-d39fdb82.js";import{D as ae}from"./DeleteOutlined-133431b9.js";import"./index-d2f8d546.js";import"./index-6887f962.js";import"./useForm-872d7ca5.js";import"./index-b2b0373a.js";import"./extendsObject-bdadc4da.js";import"./fade-e1fcf046.js";import"./useClosable-f6b9b093.js";var ne={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 305H624V192c0-17.7-14.3-32-32-32H184v-40c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v784c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V640h248v113c0 17.7 14.3 32 32 32h416c17.7 0 32-14.3 32-32V337c0-17.7-14.3-32-32-32zM184 568V232h368v336H184zm656 145H504v-73h112c4.4 0 8-3.6 8-8V377h216v336z"}}]},name:"flag",theme:"outlined"};const le=ne;var ie=function(u,A){return m.createElement(R,U({},u,{ref:A,icon:le}))},re=m.forwardRef(ie);const F=re,{Option:x}=w,we=()=>{const[h,u]=m.useState(X),[A,p]=m.useState(!1),[i,f]=m.useState(null),[O,C]=m.useState(!1),T=s=>{switch(s){case"active":return"green";case"draft":return"orange";case"archived":return"gray";case"flagged":return"red";default:return"default"}},E=async s=>{C(!0);try{const t=b(i.id,s);t&&(u(a=>a.map(l=>l.id===i.id?t:l)),p(!1),f(null),c.success("Assessment updated successfully!"))}catch{c.error("Failed to update assessment")}finally{C(!1)}},D=async s=>{try{G(s)&&(u(a=>a.filter(l=>l.id!==s)),c.success("Assessment deleted successfully!"))}catch{c.error("Failed to delete assessment")}},z=async s=>{try{const t=s.status==="flagged"?"active":"flagged",a=b(s.id,{status:t});a&&(u(l=>l.map(r=>r.id===s.id?a:r)),c.success(`Assessment ${t==="flagged"?"flagged":"unflagged"} successfully!`))}catch{c.error("Failed to update assessment status")}},P=async s=>{try{const t=b(s.id,{status:"archived"});t&&(u(a=>a.map(l=>l.id===s.id?t:l)),c.success("Assessment archived successfully!"))}catch{c.error("Failed to archive assessment")}},V=s=>{const t=k.filter(r=>r.assessmentId===s),a=t.filter(r=>r.status==="evaluated"),l=a.length>0?Math.round(a.reduce((r,L)=>r+L.percentage,0)/a.length):0;return{totalSubmissions:t.length,evaluatedSubmissions:a.length,averageScore:l}},M=[{title:"Assessment",dataIndex:"title",key:"title",render:(s,t)=>n("div",{children:[e("div",{className:"font-medium",children:s}),e("div",{className:"text-sm text-gray-600",children:t.subject})]})},{title:"Instructor",dataIndex:"instructorName",key:"instructor",render:s=>e("span",{children:s})},{title:"Type",dataIndex:"type",key:"type",render:s=>e(I,{color:"blue",children:s.charAt(0).toUpperCase()+s.slice(1)})},{title:"Status",dataIndex:"status",key:"status",render:s=>e(I,{color:T(s),children:s.charAt(0).toUpperCase()+s.slice(1)})},{title:"Students",dataIndex:"enrolledStudents",key:"students",render:s=>n("div",{className:"flex items-center space-x-1",children:[e(Q,{}),e("span",{children:s.length})]})},{title:"Submissions",key:"submissions",render:(s,t)=>{const a=V(t.id);return n("div",{className:"text-center",children:[n("div",{className:"font-medium",children:[a.evaluatedSubmissions,"/",a.totalSubmissions]}),e("div",{className:"text-sm text-gray-600",children:a.averageScore>0?`${a.averageScore}% avg`:"No scores"})]})}},{title:"Created",dataIndex:"createdAt",key:"createdAt",render:s=>new Date(s).toLocaleDateString()},{title:"Actions",key:"actions",render:(s,t)=>n(N,{children:[e(d,{type:"link",icon:e(J,{}),size:"small",children:"View"}),e(d,{type:"link",icon:e(K,{}),size:"small",onClick:()=>{f(t),p(!0)},children:"Edit"}),e(d,{type:(t.status==="flagged","link"),danger:t.status!=="flagged",icon:e(F,{}),size:"small",onClick:()=>z(t),children:t.status==="flagged"?"Unflag":"Flag"}),t.status!=="archived"&&e(d,{type:"link",icon:e(te,{}),size:"small",onClick:()=>P(t),children:"Archive"}),e(ee,{title:"Delete Assessment",description:"Are you sure you want to delete this assessment? This action cannot be undone.",onConfirm:()=>D(t.id),okText:"Delete",cancelText:"Cancel",okButtonProps:{danger:!0},children:e(d,{type:"link",danger:!0,icon:e(ae,{}),size:"small",children:"Delete"})})]})}],$=h.length,q=h.filter(s=>s.status==="active").length,B=h.filter(s=>s.status==="flagged").length,j=k.length,H=k.filter(s=>s.status==="evaluated").length;return n("div",{className:"p-6",children:[n("div",{className:"mb-6",children:[e("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Assessment Oversight"}),e("p",{className:"text-gray-600 dark:text-gray-400",children:"Monitor and manage all assessments on the platform"})]}),n(W,{gutter:[16,16],className:"mb-6",children:[e(y,{xs:24,sm:6,children:e(g,{className:"text-center",children:e(S,{title:"Total Assessments",value:$,prefix:e(_,{}),valueStyle:{color:"#1890ff"}})})}),e(y,{xs:24,sm:6,children:e(g,{className:"text-center",children:e(S,{title:"Active Assessments",value:q,prefix:e(se,{}),valueStyle:{color:"#52c41a"}})})}),e(y,{xs:24,sm:6,children:e(g,{className:"text-center",children:e(S,{title:"Flagged Assessments",value:B,prefix:e(F,{}),valueStyle:{color:"#f5222d"}})})}),e(y,{xs:24,sm:6,children:n(g,{className:"text-center",children:[e(S,{title:"Total Submissions",value:j,valueStyle:{color:"#722ed1"}}),n("div",{className:"text-sm text-gray-600 mt-2",children:[H," evaluated"]})]})})]}),e(g,{children:e(Y,{columns:M,dataSource:h,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(s,t)=>`${t[0]}-${t[1]} of ${s} assessments`}})}),e(Z,{title:"Edit Assessment",open:A,onCancel:()=>{p(!1),f(null)},footer:null,width:600,children:i&&n(o,{layout:"vertical",onFinish:E,initialValues:{title:i.title,description:i.description,status:i.status,duration:i.duration,passingScore:i.passingScore},children:[e(o.Item,{name:"title",label:"Title",rules:[{required:!0,message:"Please enter assessment title"}],children:e(v,{placeholder:"Enter assessment title"})}),e(o.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter assessment description"}],children:e(v.TextArea,{rows:3,placeholder:"Enter assessment description"})}),e(o.Item,{name:"status",label:"Status",rules:[{required:!0,message:"Please select status"}],children:n(w,{placeholder:"Select status",children:[e(x,{value:"draft",children:"Draft"}),e(x,{value:"active",children:"Active"}),e(x,{value:"archived",children:"Archived"}),e(x,{value:"flagged",children:"Flagged"})]})}),e(o.Item,{name:"duration",label:"Duration (minutes)",rules:[{required:!0,message:"Please enter duration"}],children:e(v,{type:"number",min:1,placeholder:"Enter duration in minutes"})}),e(o.Item,{name:"passingScore",label:"Passing Score (%)",rules:[{required:!0,message:"Please enter passing score"}],children:e(v,{type:"number",min:0,max:100,placeholder:"Enter passing score"})}),e(o.Item,{className:"mb-0 text-right",children:n(N,{children:[e(d,{onClick:()=>{p(!1),f(null)},children:"Cancel"}),e(d,{type:"primary",htmlType:"submit",loading:O,children:"Update Assessment"})]})})]})})]})};export{we as default};
