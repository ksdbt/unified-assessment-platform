import{aa as I,ab as o,ac as H,u as V,f,a as s,j as e,C as w,A as K,U as v,s as x,ad as U,B as Q,ae as L,af as O,I as n,$ as m}from"./index-7e43eeaa.js";import{c as Y}from"./assessments-75df469f.js";import{b as G}from"./submissions-daaf532e.js";import{U as J,a as W,m as X}from"./UploadOutlined-65b8399a.js";import{R as Z,C as p}from"./row-43cc7f0c.js";import{S as u}from"./index-3a5ddc68.js";import{F as q}from"./index-8494a245.js";import{C as _}from"./CheckCircleOutlined-8efca08c.js";import{P as ee,H as ae}from"./PhoneOutlined-2a472f7c.js";import{S as T}from"./SaveOutlined-c79f92fe.js";import"./fade-e1fcf046.js";import"./DeleteOutlined-133431b9.js";import"./DownloadOutlined-626b5515.js";import"./progress-213077d5.js";import"./index-d2f8d546.js";import"./useForm-872d7ca5.js";const{TabPane:F}=L,se=I().shape({name:o().required("Name is required"),email:o().email("Invalid email").required("Email is required"),phone:o(),address:o()}),te=I().shape({currentPassword:o().required("Current password is required"),newPassword:o().min(6,"Password must be at least 6 characters").required("New password is required"),confirmPassword:o().oneOf([H("newPassword"),null],"Passwords must match").required("Please confirm your password")}),be=()=>{var N,y,S,C,A,k;const{user:r,updateUser:P}=V(),[z,E]=f.useState("1"),[j,b]=f.useState(!1),[R,g]=f.useState(!1),B=async t=>{b(!0);try{await new Promise(a=>setTimeout(a,1e3)),P(t),m.success("Profile updated successfully!")}catch{m.error("Failed to update profile")}finally{b(!1)}},D=async(t,{resetForm:a})=>{g(!0);try{await new Promise(i=>setTimeout(i,1e3)),m.success("Password changed successfully!"),a()}catch{m.error("Failed to change password")}finally{g(!1)}},M=t=>{if(t.file.status==="done"){const a=URL.createObjectURL(t.file.originFileObj);P({avatar:a}),X.success("Avatar updated successfully")}},d=Y(r.id),$=G().filter(t=>d.some(a=>a.id===t.assessmentId)),c={totalAssessments:d.length,activeAssessments:d.filter(t=>t.status==="active").length,pendingEvaluations:$.length,totalStudents:[...new Set(d.flatMap(t=>t.enrolledStudents))].length};return s("div",{className:"p-6 max-w-4xl mx-auto",children:[s("div",{className:"mb-6",children:[e("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"My Profile"}),e("p",{className:"text-gray-600 dark:text-gray-400",children:"Manage your account information and preferences"})]}),s("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s("div",{className:"lg:col-span-1",children:[s(w,{className:"text-center",children:[e(K,{size:120,src:r.avatar,icon:e(v,{}),className:"mb-4"}),e("h2",{className:"text-xl font-bold mb-2",children:r.name}),e("p",{className:"text-gray-600 mb-4",children:r.role.charAt(0).toUpperCase()+r.role.slice(1)}),e(J,{showUploadList:!1,beforeUpload:()=>!1,onChange:M,children:e(x,{icon:e(W,{}),children:"Change Avatar"})}),s("div",{className:"mt-6 space-y-2 text-left",children:[s("div",{className:"flex items-center space-x-2",children:[e(U,{}),e("span",{className:"text-sm",children:r.email})]}),e("div",{className:"flex items-center space-x-2",children:s("span",{className:"text-sm",children:["Institute: ",r.instituteCode]})}),((N=r.profile)==null?void 0:N.department)&&e("div",{className:"flex items-center space-x-2",children:s("span",{className:"text-sm",children:["Department: ",r.profile.department]})})]})]}),e(w,{className:"mt-6",title:"Teaching Stats",children:s(Z,{gutter:[16,16],children:[e(p,{span:12,children:e(u,{title:"Assessments",value:c.totalAssessments,prefix:e(Q,{}),valueStyle:{color:"#1890ff"}})}),e(p,{span:12,children:e(u,{title:"Active",value:c.activeAssessments,prefix:e(_,{}),valueStyle:{color:"#52c41a"}})}),e(p,{span:12,children:e(u,{title:"Students",value:c.totalStudents,prefix:e(v,{}),valueStyle:{color:"#722ed1"}})}),e(p,{span:12,children:e(u,{title:"Pending Reviews",value:c.pendingEvaluations,valueStyle:{color:"#faad14"}})})]})})]}),e("div",{className:"lg:col-span-2",children:e(w,{children:s(L,{activeKey:z,onChange:E,children:[e(F,{tab:"Personal Information",children:e(O,{initialValues:{name:r.name||"",email:r.email||"",phone:((y=r.profile)==null?void 0:y.phone)||"",address:((S=r.profile)==null?void 0:S.address)||"",department:((C=r.profile)==null?void 0:C.department)||"",specialization:((A=r.profile)==null?void 0:A.specialization)||"",experience:((k=r.profile)==null?void 0:k.experience)||""},validationSchema:se,onSubmit:B,children:({values:t,errors:a,touched:i,handleChange:l,handleSubmit:h})=>s(q,{layout:"vertical",onSubmit:h,children:[s("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s("div",{children:[e("label",{className:"block text-sm font-medium mb-2",children:"Full Name"}),e(n,{name:"name",value:t.name,onChange:l,prefix:e(v,{}),status:a.name&&i.name?"error":""}),a.name&&i.name&&e("div",{className:"text-red-500 text-sm mt-1",children:a.name})]}),s("div",{children:[e("label",{className:"block text-sm font-medium mb-2",children:"Email"}),e(n,{name:"email",value:t.email,onChange:l,prefix:e(U,{}),status:a.email&&i.email?"error":""}),a.email&&i.email&&e("div",{className:"text-red-500 text-sm mt-1",children:a.email})]}),s("div",{children:[e("label",{className:"block text-sm font-medium mb-2",children:"Phone"}),e(n,{name:"phone",value:t.phone,onChange:l,prefix:e(ee,{})})]}),s("div",{children:[e("label",{className:"block text-sm font-medium mb-2",children:"Department"}),e(n,{name:"department",value:t.department,onChange:l,placeholder:"e.g., Computer Science"})]}),s("div",{children:[e("label",{className:"block text-sm font-medium mb-2",children:"Specialization"}),e(n,{name:"specialization",value:t.specialization,onChange:l,placeholder:"e.g., Data Structures"})]}),s("div",{children:[e("label",{className:"block text-sm font-medium mb-2",children:"Years of Experience"}),e(n,{name:"experience",type:"number",value:t.experience,onChange:l,placeholder:"e.g., 5"})]})]}),s("div",{className:"mt-4",children:[e("label",{className:"block text-sm font-medium mb-2",children:"Address"}),e(n,{name:"address",value:t.address,onChange:l,prefix:e(ae,{})})]}),e("div",{className:"mt-6",children:e(x,{type:"primary",htmlType:"submit",icon:e(T,{}),loading:j,children:"Update Profile"})})]})})},"1"),e(F,{tab:"Change Password",children:e(O,{initialValues:{currentPassword:"",newPassword:"",confirmPassword:""},validationSchema:te,onSubmit:D,children:({values:t,errors:a,touched:i,handleChange:l,handleSubmit:h})=>s(q,{layout:"vertical",onSubmit:h,children:[s("div",{className:"space-y-4",children:[s("div",{children:[e("label",{className:"block text-sm font-medium mb-2",children:"Current Password"}),e(n.Password,{name:"currentPassword",value:t.currentPassword,onChange:l,status:a.currentPassword&&i.currentPassword?"error":""}),a.currentPassword&&i.currentPassword&&e("div",{className:"text-red-500 text-sm mt-1",children:a.currentPassword})]}),s("div",{children:[e("label",{className:"block text-sm font-medium mb-2",children:"New Password"}),e(n.Password,{name:"newPassword",value:t.newPassword,onChange:l,status:a.newPassword&&i.newPassword?"error":""}),a.newPassword&&i.newPassword&&e("div",{className:"text-red-500 text-sm mt-1",children:a.newPassword})]}),s("div",{children:[e("label",{className:"block text-sm font-medium mb-2",children:"Confirm New Password"}),e(n.Password,{name:"confirmPassword",value:t.confirmPassword,onChange:l,status:a.confirmPassword&&i.confirmPassword?"error":""}),a.confirmPassword&&i.confirmPassword&&e("div",{className:"text-red-500 text-sm mt-1",children:a.confirmPassword})]})]}),e("div",{className:"mt-6",children:e(x,{type:"primary",htmlType:"submit",icon:e(T,{}),loading:R,children:"Change Password"})})]})})},"2")]})})})]})]})};export{be as default};
